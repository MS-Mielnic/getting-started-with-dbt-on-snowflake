models:
  - name: "High_value_customer_seg"
    description: "Table containing customer loyalty and sales metrics"
    columns:
      - name: total_sales
        description: "The total revenue generated by the customer"
        tests:
          - is_positive_amount  # Your first test (checks for NULL and <= 0)

      - name: loyalty_segment
        description: "VIP, Regular, or Occasional status based on sales"
        tests:
          - is_valid_loyalty_segment:
              sales_column: total_sales  # Your second test (checks logic)
              column_name: loyalty_semgent